<!DOCTYPE html>
<html>
  <head>
    <title>Project-"Farm"</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="docs/favicon.ico?v=0">
    <!-- import the webpage's stylesheet -->
    <link rel="stylesheet" href="docs/style.css">
    <!-- import the webpage's javascript file -->
    <script src="docs/script.js"></script>
  </head>  
  <body>
	<div id="title">
	    Управление микроклиматом в теплице
	</div>
	<div id="leftside">
		<h2>Оглавление</h2>
			<p><a href="#top">Цель проекта</a></p>
			<p><a href="#diag">Диаграмма компонентов проекта</a></p>
			<p><a href="#cmps">Описание компонентов</a></p>
			<p><a href="#files">Получение исполняемых файлов и запуск</a></p>
			<p><a href="#scrn">Скриншоты</a></p>
			<p><a href="#lic">Лицензия MIT</a></p>
		<h3>Контакты</h3>
			<p>e-mail: ds7428894@yandex.ru <br>
			в <b>Теме</b> письма обязательно слово <b>farm</b><p> 
	</div><div id="content">
		<h2 id="top">Цель проекта</h2>
			<p>Демонстрация рабочего ПО для управления климатом в теплице для сбора требований под конкретного заказчика.
			 Ограничение данного ПО  только в том, что микроконтроллер ESP32 или Arduino UNO эмулирует работу с датчиками
			и испольнительными устройствами. Данные от датчиков генерируется в программе. Могу разработать ПО
			под ваш конкретный объект управления или устройство.
		  </p>
		<h2 id="diag">Диаграмма компонентов проекта</h2>
			<img src="docs/farm_components.jpg" >
		<h2 id="cmps">Описание компонентов</h2>
		<h3>Controller</h3>
		<p> Осуществляет управление исполнительными механизмами,осуществляющими орошение, отопление, освещение.
		собирает информацию с датчиков, необходимую для функций управления. Работает автономно по сценарию заданному клиентом. 
		При наличии соединения с интернетом регулярно обновляет на сервере текущие значения датчиков и свои настройки сценария.
		Контроллеров может быть несколько. Контроллер может быть реализован на разных аппаратных платформах, в этом проекте в качестве
		примера реализовано на:
		<ul>
			<li>модуле с ESP32 - самый дешевый вариант порядка $10. Требуется точка доступа WIFI или телефон для доступа в интернет. </li>
			<li>микрокомпьютере Rasberry PI с подключенным к нему по интерфейсу UART модулем Arduino UNO - вариант порядка $30-50. 
			Требуется точка доступа LAN для доступа в интернет по кабелю. </li>
			<li>персональном компьютере под Linux с подключенным к нему по интерфейсу UART модулем Arduino UNO - вариант для отладки системы.</li>
		</ul>
		</p>
		<h3>Server</h3>
		<p> Расположен на публично доступном ресурсе в интернете, например на вашем VDS. Предоставляет клиенту информацию о наличии соединения с контроллером, 
			текущем значении датчиков и заданных параметров для исполнительных механизмов. Может обслуживать несколько клиентов и контроллеров.
			Демонстрируются варианты:
			<ul>
			<li> WebServer на основе Node.js. Cерверное приложение написано на языке JavaScript. Контроллеры подключаются по протоколу TCP к порту 8080.
			Браузер подключается к порту 8000. При получении данных от клиента, браузер уведомляется по websocket.</li>
			<li> Сервер представляет из себя коммутатор двух TCP соединений: клиент-сервер (порт 5025), сервер-контроллер(порт 8080).
			 Этот подход предназначен для использования 
			"толстого клиента", написанного на JavaFX, по протоколу TCP. При наличии обоих TCP подключений к Серверу, 
			он транслирует данные принятые от клиента к контроллеру и в обратную сторону.
			Коммутатор написан на С++ и будет работать только под Линуксом. </li>
			<li>Существует экспериментальная реализация WebServer на чистой	JavaSE без использования сторонних библиотек,
			 если нужно серверное приложение на Java и нет желания использовать Tomcat и т.п.
		     На данный момент она не рабочая, так как в ней не реализована поддержка websocket.</li>
			</ul>
		</p>
		<h3>Client</h3>	
		<p>При наличии соединения с интернетом подключается к Серверу и предоставляет интерфейс для управления и получения информации о
		 работе системы. Демонстрируется два возможных подхода: подключиться браузером к серверу по протоколу HTTP, или
		 использовать специальный "толстый клиент", написанный на JavaFX, по протоколу TCP. В первом случае удобно, что можно использовать
	     практически любое устройство на котором есть браузер. Во втором случае преимущество в том, что потенциально можно интегрироваться
         с какой либо локальной системой пользователя. JavaFX клиент для работы требует установки JRE версии старше 1.8.102 и будет
		 работать под Linux, Windows. К Серверу может подключаться несколько клиентов.
		</p>
		<h2 id="files">Получение исполняемых файлов ПО, сборка, установка, запуск</h2>
		<h3>farm_javafx_client</h3>
		<p> "Толстый клиент" для управления Контроллером по протоколу TCP.
		 Исполняемый jar файл находится в каталоге farm/client/thick_client/farm_javafx_client/
	     Для запуска под JRE 1.8 используйте команду в консоле:
		<pre>$ java -jar farm_javafx_client.jar </pre>
		Для запуска под JRE 11 надо дополнительно установить отдельно javafx-sdk, при запуске указать к ней путь в вашем случае:	
		<pre>$ java -jar --module-path  /home/user/bin/javafx-sdk-11.0.2/lib  --add-modules=javafx.controls,javafx.fxml farm_javafx_client.jar</pre>
			Для сборки из исходного кода импортируйте проект в Eclipse IDE for Java SE developers и запускайте проект оттуда. Если у вас 
			версия JRE 11 и выше в настройках run_configurations -> Arguments -> VM Arguments укажите:
			<pre>--module-path  /home/user/bin/javafx-sdk-11.0.2/lib --add-modules=javafx.controls,javafx.fxml </pre>
		</p> 
		<h3>farm_commutator</h3>
		<p>Коммутатор двух TCP соединений: клиент-сервер, сервер-контроллер.
		 Исполняемый файл farm_commutator находится в каталоге
		 farm/server/tcp_commutator/farm_commutator/ его необходимо скопировать например на свой VDS и запустить его там:
		<pre>$ scp farm_commutator user@ip_вашего_VDS:/home/user </pre>
		 <pre>$ ssh user@ip_вашего_VDS '/home/user/farm_commutator &' </pre>
		Для сборки из исходного кода импортируйте проект в Eclipse IDE for C/C++ developers и собирайте проект оттуда.
		В проекте есть сборка через CMake, для этого запустите скрипт build_x86-64.sh исполняемый файл появится в каталоге bin/
		</p>
		<h3>farm_nodejs_server</h3>
		<p>Скопируйте все содержимое папки farm/server/web_server/farm_nodejs_server/ например на свой VDS. Установите Node.js c его сайта.
		 Войдите в каталог с проектом на вашем VDS и запустите:
		<pre>$ cd ~/bin/farm_nodejs_server</pre>
		<pre>$ node farm.js &</pre>
		</p>
		<h3>farm_rpi_ctrl</h3>
		<p>Контроллер на платформе RaspberryPI. Исполняемый файл farm_rpi_ctrl находится в каталоге farm/controller/raspberry_pi/farm_rpi_ctrl/  
		  его необходимо скопировать на RaspberryPI и запустить его там.
		  Для сборки из исходного кода импортируйте проект в Eclipse IDE for C/C++ developers и собирайте проект оттуда.
		  В проекте есть сборка через CMake, для этого запустите скрипт build_pi.sh исполняемый файл появится в каталоге bin/<br>
		  Для отладки можно собрать проект для работы на ПК для этого запустите скрипт build_x86-64.sh
		</p>
		<h3>farm_esp32_ctrl</h3>
		<p>	В каталоге находится проект для Arduino IDE. Откройте его командой Файл->Открыть... В файле найдите строчку "customize this section".
			Поставьте фактическое значение для трех параметров: имя точки доступа, пароль, IP адрес сервера VDS
			Загрузите проект в подключенную плату ESP32.
		</p>
		<h3>farm_x86_ctrl</h3>
		<p>Эмулятор контроллера на ПК. Исполняемый файл farm_x86_ctrl находится в каталоге farm/controller/x86_pc/farm_x86_ctrl/ 
		 Запустите эмулятор на ПК:
		<pre>$ cd farm/farm_x86_ctr</pre>
		<pre>$ ./farm_x86_ctr</pre>
		</p>
		<h3>farm_uno_ctrl</h3>
		<p>	В каталоге находится проект для Arduino IDE. Откройте его командой Файл->Открыть... 
			Загрузите проект в подключенную плату UNO.
		</p>
		<h2 id="scrn">Скриншоты</h2>
		<h3>Вид приложения  farm_javafx_client </h3>
			<img src="docs/thick_client.png" >
		<h3>Вид приложения в Браузере - ориентация на телефон в портретном режиме</h3>
			<img src="docs/web.png" >
		<h2 id="lic">Лицензия MIT</h2>	
			Copyright (c) 2020 by sda1969<br><br>
			Данная лицензия разрешает лицам, получившим копию данного программного обеспечения и сопутствующей документации
			(в дальнейшем именуемыми «Программное обеспечение»), безвозмездно использовать Программное обеспечение без ограничений,
			включая неограниченное право на использование, копирование, изменение, слияние, публикацию, распространение,
			сублицензирование и/или продажу копий Программного обеспечения, а также лицам, которым предоставляется данное Программное обеспечение,
			при соблюдении следующих условий:<br>
			Указанное выше уведомление об авторском праве и данные условия должны быть включены во все копии или значимые части данного Программного обеспечения.<br>
			ДАННОЕ ПРОГРАММНОЕ ОБЕСПЕЧЕНИЕ ПРЕДОСТАВЛЯЕТСЯ «КАК ЕСТЬ», БЕЗ КАКИХ-ЛИБО ГАРАНТИЙ, ЯВНО ВЫРАЖЕННЫХ ИЛИ ПОДРАЗУМЕВАЕМЫХ,
			ВКЛЮЧАЯ ГАРАНТИИ ТОВАРНОЙ ПРИГОДНОСТИ, СООТВЕТСТВИЯ ПО ЕГО КОНКРЕТНОМУ НАЗНАЧЕНИЮ И ОТСУТСТВИЯ НАРУШЕНИЙ, НО НЕ ОГРАНИЧИВАЯСЬ ИМИ.
			НИ В КАКОМ СЛУЧАЕ АВТОРЫ ИЛИ ПРАВООБЛАДАТЕЛИ НЕ НЕСУТ ОТВЕТСТВЕННОСТИ ПО КАКИМ-ЛИБО ИСКАМ, ЗА УЩЕРБ ИЛИ ПО ИНЫМ ТРЕБОВАНИЯМ, В ТОМ ЧИСЛЕ,
			ПРИ ДЕЙСТВИИ КОНТРАКТА, ДЕЛИКТЕ ИЛИ ИНОЙ СИТУАЦИИ, ВОЗНИКШИМ ИЗ-ЗА ИСПОЛЬЗОВАНИЯ ПРОГРАММНОГО ОБЕСПЕЧЕНИЯ ИЛИ ИНЫХ ДЕЙСТВИЙ С ПРОГРАММНЫМ ОБЕСПЕЧЕНИЕМ. 	
	</div>
  </body>
</html>
